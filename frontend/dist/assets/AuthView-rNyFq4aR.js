import{d as S,u as T,r as i,a as p,c as $,o as j,b as e,w as a,e as o,f as V,t as F,g as c,h as A,E as g,i as D,j as I,_ as z}from"./index-ONXd2yip.js";import{e as C}from"./errors-BvGLt0H_.js";const G={class:"auth-wrapper"},H={class:"auth-header"},J=S({__name:"AuthView",setup(O){const h=D(),K=I(),{login:U,register:E}=T(),d=i("login"),f=i(),_=i(),s=p({username:"",password:""}),n=p({username:"",password:""}),B=p({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:64,message:"用户名长度需在 3 到 64 个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少为 6 个字符",trigger:"blur"}]}),L=p({username:[{required:!0,message:"请设置用户名",trigger:"blur"},{min:3,max:64,message:"用户名长度需在 3 到 64 个字符之间",trigger:"blur"}],password:[{required:!0,message:"请设置密码",trigger:"blur"},{min:8,message:"密码长度至少为 8 个字符",trigger:"blur"}]}),b=i(!1),w=i(!1);async function y(){if(f.value){try{await f.value.validate()}catch{return}b.value=!0;try{const t=await U({...s});g.success(`欢迎回来，${t.username}！`),R()}catch(t){g.error(C(t))}finally{b.value=!1}}}async function v(){if(_.value){try{await _.value.validate()}catch{return}w.value=!0;try{const t=await E({...n});g.success(`账户已创建，欢迎你，${t.username}！`),R()}catch(t){g.error(C(t))}finally{w.value=!1}}}function R(){const t=typeof h.query.redirect=="string"?h.query.redirect:"/";K.replace(t||"/")}return(t,r)=>{const m=o("el-input"),u=o("el-form-item"),x=o("el-button"),k=o("el-form"),q=o("el-tab-pane"),N=o("el-tabs"),M=o("el-card");return j(),$("div",G,[e(M,{class:"auth-card"},{default:a(()=>[V("div",H,[V("h2",null,F(d.value==="login"?"欢迎回来":"创建新账户"),1),V("p",null,F(d.value==="login"?"登录后继续":"注册后开始使用分析功能"),1)]),e(N,{modelValue:d.value,"onUpdate:modelValue":r[4]||(r[4]=l=>d.value=l),class:"auth-tabs"},{default:a(()=>[e(q,{label:"登录",name:"login"},{default:a(()=>[e(k,{ref_key:"loginFormRef",ref:f,model:s,rules:B,"label-position":"top"},{default:a(()=>[e(u,{label:"用户名",prop:"username"},{default:a(()=>[e(m,{modelValue:s.username,"onUpdate:modelValue":r[0]||(r[0]=l=>s.username=l),placeholder:"请输入用户名",onKeyup:c(y,["enter"])},null,8,["modelValue"])]),_:1}),e(u,{label:"密码",prop:"password"},{default:a(()=>[e(m,{modelValue:s.password,"onUpdate:modelValue":r[1]||(r[1]=l=>s.password=l),type:"password","show-password":"",placeholder:"请输入密码",onKeyup:c(y,["enter"])},null,8,["modelValue"])]),_:1}),e(u,null,{default:a(()=>[e(x,{type:"primary",loading:b.value,onClick:y},{default:a(()=>[...r[5]||(r[5]=[A("登录",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),e(q,{label:"注册",name:"register"},{default:a(()=>[e(k,{ref_key:"registerFormRef",ref:_,model:n,rules:L,"label-position":"top"},{default:a(()=>[e(u,{label:"用户名",prop:"username"},{default:a(()=>[e(m,{modelValue:n.username,"onUpdate:modelValue":r[2]||(r[2]=l=>n.username=l),placeholder:"请设置用户名",onKeyup:c(v,["enter"])},null,8,["modelValue"])]),_:1}),e(u,{label:"密码",prop:"password"},{default:a(()=>[e(m,{modelValue:n.password,"onUpdate:modelValue":r[3]||(r[3]=l=>n.password=l),type:"password","show-password":"",placeholder:"请设置安全的密码",onKeyup:c(v,["enter"])},null,8,["modelValue"])]),_:1}),e(u,null,{default:a(()=>[e(x,{type:"primary",loading:w.value,onClick:v},{default:a(()=>[...r[6]||(r[6]=[A("注册并登录",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}}),W=z(J,[["__scopeId","data-v-552d628e"]]);export{W as default};
