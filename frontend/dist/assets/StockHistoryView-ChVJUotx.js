import{t as K,e as M,b as P}from"./stockAnalysis-72SBhG5I.js";import{S as q}from"./StockAdvicePanel-0uHkC2oq.js";import{K as O}from"./KLineChart-Bpe7rvZr.js";import{f as x,t as $}from"./display-CuAyYhFG.js";import{d as J,r as c,n as g,s as j,c as f,o as n,b as l,w as t,e as s,f as i,m as y,h as p,t as d,k as w,p as z,F as G,_ as Q}from"./index-ONXd2yip.js";const W={class:"stock-history"},X={class:"toolbar"},Y={class:"dialog-header"},Z={key:0,class:"dialog-body"},ee={class:"dialog-meta"},le={key:1},te=J({__name:"StockHistoryView",setup(ae){const u=c(!1),b=c([]),a=c(null),m=c(!1),v=c("ALL"),C=g(()=>v.value==="ALL"?b.value:b.value.filter(r=>r.analysisType===v.value)),h=g(()=>!a.value||a.value.analysisType!=="STRUCTURED"?null:K(a.value.analysis)),V=g(()=>{if(!a.value||a.value.analysisType!=="STRUCTURED")return[];try{return M(a.value.analysis)}catch{return[]}}),D={COMPREHENSIVE:"综合分析",STRUCTURED:"结构化分析"};function R(r){return D[r]??r}async function E(){u.value=!0;try{b.value=await P()}finally{u.value=!1}}function L(r){a.value=r,m.value=!0}return j(E),(r,e)=>{const k=s("el-option"),A=s("el-select"),S=s("el-form-item"),T=s("el-button"),N=s("el-form"),_=s("el-table-column"),H=s("el-table"),U=s("el-empty"),B=s("el-card"),F=s("el-dialog");return n(),f("div",W,[l(B,{class:"history-card",shadow:"hover"},{header:t(()=>[...e[3]||(e[3]=[i("div",{class:"card-title"}," 近期分析记录 ",-1)])]),default:t(()=>[i("div",X,[l(N,{inline:"","label-position":"left"},{default:t(()=>[l(S,{label:"筛选类型"},{default:t(()=>[l(A,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=o=>v.value=o),style:{width:"180px"}},{default:t(()=>[l(k,{label:"全部",value:"ALL"}),l(k,{label:"综合分析",value:"COMPREHENSIVE"}),l(k,{label:"结构化分析",value:"STRUCTURED"})]),_:1},8,["modelValue"])]),_:1}),l(S,null,{default:t(()=>[l(T,{loading:u.value,onClick:E},{default:t(()=>[...e[4]||(e[4]=[p("刷新",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),C.value.length?(n(),y(H,{key:0,data:C.value,loading:u.value,border:"",height:"560"},{default:t(()=>[l(_,{prop:"stockCode",label:"股票",width:"160"}),l(_,{prop:"analysisType",label:"类型",width:"140"},{default:t(o=>[p(d(R(o.row.analysisType)),1)]),_:1}),l(_,{label:"生成时间",width:"220"},{default:t(o=>[p(d(w(x)(o.row.requestedAt)),1)]),_:1}),l(_,{label:"详情","min-width":"180",align:"center"},{default:t(o=>[l(T,{type:"primary",link:"",onClick:I=>L(o.row)},{default:t(()=>[...e[5]||(e[5]=[p("查看详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","loading"])):(n(),y(U,{key:1,description:u.value?"加载中...":"暂无历史记录"},null,8,["description"]))]),_:1}),l(F,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=o=>m.value=o),width:"70%","show-close":!1},{header:t(()=>{var o;return[i("div",Y,[i("span",null,"分析详情："+d((o=a.value)==null?void 0:o.stockCode),1),l(T,{text:"",type:"primary",onClick:e[1]||(e[1]=I=>m.value=!1)},{default:t(()=>[...e[6]||(e[6]=[p("关闭",-1)])]),_:1})])]}),default:t(()=>[a.value?(n(),f("div",Z,[i("p",ee,d(R(a.value.analysisType))+" · "+d(w(x)(a.value.requestedAt)),1),a.value.analysisType==="STRUCTURED"&&h.value?(n(),f(G,{key:0},[l(q,{data:h.value},null,8,["data"]),e[7]||(e[7]=i("div",{class:"dialog-divider"},null,-1)),e[8]||(e[8]=i("div",{class:"kline-header"},[i("h4",{class:"section-sub-title"},"K线图")],-1)),V.value.length?(n(),y(O,{key:1,candles:V.value,height:420},null,8,["candles"])):(n(),y(U,{key:0,description:"无时间序列"}))],64)):(n(),f("pre",le,d(w($)(a.value.analysis)),1))])):z("",!0)]),_:1},8,["modelValue"])])}}}),de=Q(te,[["__scopeId","data-v-032a1edb"]]);export{de as default};
